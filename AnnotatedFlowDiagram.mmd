flowchart TD
    %% Use Case Flow (Main Path)
    Start([User Enters URL]) --> Step1[Step 1: Receive URL Input]
    Step1 --> Step2[Step 2: Validate Format]
    Step2 --> Step3[Step 3: Check Accessibility]
    Step3 --> Step4[Step 4: Security Screening]
    Step4 --> Success([URL Validated Successfully])
    
    %% Architecture Component Annotations for Each Step
    Step1 -.-> Arch1[ğŸ—ï¸ Architecture Components<br/>â€¢ Load Balancer: Nginx/AWS ALB<br/>â€¢ API Gateway: Kong/AWS Gateway<br/>â€¢ Auth Service: OAuth 2.0/JWT<br/>â€¢ Rate Limiter: Redis-based throttling]
    
    Step2 -.-> Arch2[ğŸ—ï¸ Architecture Components<br/>â€¢ Validation Service: Node.js/Spring Boot<br/>â€¢ Regex Engine: Built-in pattern matching<br/>â€¢ Cache Manager: Redis client wrapper<br/>â€¢ Pattern Matcher: RFC 3986 compliance]
    
    Step3 -.-> Arch3[ğŸ—ï¸ Architecture Components<br/>â€¢ HTTP Client: Axios/OkHttp pool<br/>â€¢ Connection Pool: 100 concurrent connections<br/>â€¢ Circuit Breaker: Hystrix/Resilience4j<br/>â€¢ DNS Resolver: System/Custom resolver]
    
    Step4 -.-> Arch4[ğŸ—ï¸ Architecture Components<br/>â€¢ Security Service: Microservice architecture<br/>â€¢ Blacklist Database: PostgreSQL with indexes<br/>â€¢ External Scanner: VirusTotal/URLVoid API<br/>â€¢ Threat Intelligence: Real-time updates]
    
    %% Non-Functional Requirements Annotations
    Step1 -.-> NFR1[âš¡ Non-Functional Requirements<br/>â€¢ Performance: Response time <200ms<br/>â€¢ Scalability: Handle 1000 req/sec<br/>â€¢ Security: 100% authentication required<br/>â€¢ Availability: 99.95% uptime target]
    
    Step2 -.-> NFR2[âš¡ Non-Functional Requirements<br/>â€¢ Performance: Validation time <50ms<br/>â€¢ Reliability: 99.9% accuracy rate<br/>â€¢ Scalability: 95% cache hit rate<br/>â€¢ Maintainability: Regex pattern updates]
    
    Step3 -.-> NFR3[âš¡ Non-Functional Requirements<br/>â€¢ Performance: 5-second timeout limit<br/>â€¢ Reliability: 3 retry attempts with backoff<br/>â€¢ Scalability: Circuit breaker at 50% failure<br/>â€¢ Operability: Health check endpoints]
    
    Step4 -.-> NFR4[âš¡ Non-Functional Requirements<br/>â€¢ Security: 100% threat screening coverage<br/>â€¢ Compliance: Log all security events<br/>â€¢ Performance: Parallel security checks<br/>â€¢ Reliability: External API fallback strategy]
    
    %% Data Flow Annotations
    Step1 -.-> Data1[ğŸ’¾ Data Operations<br/>â€¢ Input: URL string, user context<br/>â€¢ Validation: Schema validation, sanitization<br/>â€¢ Storage: Request metadata in Redis<br/>â€¢ Output: Validated request object]
    
    Step2 -.-> Data2[ğŸ’¾ Data Operations<br/>â€¢ Input: Raw URL string<br/>â€¢ Processing: Regex pattern matching<br/>â€¢ Caching: Store validation results TTL 1hr<br/>â€¢ Output: Format validation result]
    
    Step3 -.-> Data3[ğŸ’¾ Data Operations<br/>â€¢ Input: Validated URL<br/>â€¢ Processing: HTTP HEAD/GET request<br/>â€¢ Caching: Store accessibility results TTL 30min<br/>â€¢ Output: Accessibility status + metadata]
    
    Step4 -.-> Data4[ğŸ’¾ Data Operations<br/>â€¢ Input: Accessible URL<br/>â€¢ Processing: Multi-source security scanning<br/>â€¢ Storage: Threat data in PostgreSQL<br/>â€¢ Output: Security assessment report]
    
    %% Error Handling Annotations
    Step1 -.-> Error1[ğŸš¨ Error Handling<br/>â€¢ Auth Failure: Return 401 with retry guidance<br/>â€¢ Rate Limit: Return 429 with retry-after header<br/>â€¢ Input Error: Return 400 with validation details<br/>â€¢ System Error: Return 503 with fallback options]
    
    Step2 -.-> Error2[ğŸš¨ Error Handling<br/>â€¢ Format Error: Return specific format violation<br/>â€¢ Cache Error: Proceed without cache, log warning<br/>â€¢ Service Error: Return 500 with correlation ID<br/>â€¢ Timeout Error: Return 504 with retry guidance]
    
    Step3 -.-> Error3[ğŸš¨ Error Handling<br/>â€¢ Network Error: Retry with exponential backoff<br/>â€¢ DNS Error: Return specific DNS failure details<br/>â€¢ Timeout Error: Return timeout with suggestions<br/>â€¢ Circuit Open: Return 503 with estimated recovery]
    
    Step4 -.-> Error4[ğŸš¨ Error Handling<br/>â€¢ Security Threat: Return 403 with threat details<br/>â€¢ External API Error: Use fallback security rules<br/>â€¢ Database Error: Continue with cached blacklist<br/>â€¢ Scanning Error: Return 502 with partial results]
    
    %% Monitoring and Observability Annotations
    Step1 -.-> Monitor1[ğŸ“Š Monitoring & Observability<br/>â€¢ Metrics: Request rate, response time, error rate<br/>â€¢ Logs: Structured JSON with correlation IDs<br/>â€¢ Tracing: Distributed tracing with OpenTelemetry<br/>â€¢ Alerts: Response time >500ms, error rate >1%]
    
    Step2 -.-> Monitor2[ğŸ“Š Monitoring & Observability<br/>â€¢ Metrics: Validation rate, cache hit rate, accuracy<br/>â€¢ Logs: Validation patterns, cache performance<br/>â€¢ Tracing: Validation component performance<br/>â€¢ Alerts: Cache hit rate <90%, validation time >100ms]
    
    Step3 -.-> Monitor3[ğŸ“Š Monitoring & Observability<br/>â€¢ Metrics: Success rate, timeout rate, retry count<br/>â€¢ Logs: External request attempts, circuit state<br/>â€¢ Tracing: Network call performance, DNS resolution<br/>â€¢ Alerts: Success rate <95%, circuit breaker open]
    
    Step4 -.-> Monitor4[ğŸ“Š Monitoring & Observability<br/>â€¢ Metrics: Threat detection rate, scan duration<br/>â€¢ Logs: Security events, threat intelligence updates<br/>â€¢ Tracing: Multi-source scanning performance<br/>â€¢ Alerts: Threat detected, external API failures]
    
    %% Alternative Flows with Annotations
    Step2 -->|Format Invalid| FormatError[âŒ Format Error Response]
    Step3 -->|Not Accessible| AccessError[âŒ Accessibility Error Response]
    Step4 -->|Security Threat| SecurityError[âŒ Security Threat Blocked]
    
    FormatError -.-> ErrorArch1[ğŸ”§ Error Architecture<br/>â€¢ Error Handler: Global exception handler<br/>â€¢ Error Logger: Structured error logging<br/>â€¢ Error Response: Standardized error format<br/>â€¢ Error Metrics: Error classification and counting]
    
    AccessError -.-> ErrorArch2[ğŸ”§ Error Architecture<br/>â€¢ Retry Logic: Exponential backoff strategy<br/>â€¢ Fallback Service: Alternative validation method<br/>â€¢ Error Cache: Cache known inaccessible URLs<br/>â€¢ User Notification: Clear error messaging]
    
    SecurityError -.-> ErrorArch3[ğŸ”§ Error Architecture<br/>â€¢ Security Logger: Immutable security event log<br/>â€¢ Threat Database: Store threat intelligence<br/>â€¢ Alert System: Real-time security notifications<br/>â€¢ Compliance Reporter: Automated compliance reports]
    
    %% Implementation Technology Annotations
    Success -.-> Tech[ğŸ› ï¸ Implementation Technologies<br/>â€¢ Backend: Node.js with Express.js framework<br/>â€¢ Database: PostgreSQL 14 with Redis 6 cache<br/>â€¢ Security: VirusTotal API + custom blacklist<br/>â€¢ Monitoring: Prometheus + Grafana + ELK stack<br/>â€¢ Deployment: Docker + Kubernetes on AWS<br/>â€¢ CI/CD: GitHub Actions with automated testing]
    
    %% Styling
 
    
    class Start,Step1,Step2,Step3,Step4,Success usecase
    class Arch1,Arch2,Arch3,Arch4,ErrorArch1,ErrorArch2,ErrorArch3 architecture
    class NFR1,NFR2,NFR3,NFR4 nfr
    class Data1,Data2,Data3,Data4 data
    class Error1,Error2,Error3,Error4,FormatError,AccessError,SecurityError error
    class Monitor1,Monitor2,Monitor3,Monitor4 monitoring
    class Tech tech